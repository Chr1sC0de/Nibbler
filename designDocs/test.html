<h1 id="nibbler-design-docs">Nibbler Design Docs</h1>
<h2 id="introduction">Introduction</h2>
<p>The nibbler trading package provides an environment for optimizing trading algorithms, as well as a direct API to several exchanges (as of now only Binance is available).</p>
<h2 id="strategy-optimization">Strategy Optimization</h2>
<p>To develop a trading strategy not only is a back test necessary to confirm the effectiveness of the strategy, but the parameters of the strategy must be optimized to maximize the strategy’s effectiveness. We can alternatively think of optimization as strategy training, and hence the two terms can be used interchangeably. To both perform the back tests and parameter optimization an environment which mimics live trading must be developed. The closer the environment is to the real trading experience the lower the discrepancy will be between the optimization and live performance. In this section of the design documentation we provide an overview of the optimization environment.</p>
<h3 id="high-level-overview">High Level Overview</h3>
<p>In figure <a href="#fig:optimizationPipeline">1</a> we show an overview of the optimization pipeline. The idea for a strategy is initially implemented in an optimization environment from which the strategy can be back tested and its internal parameters can be optimized. Once the user is satisfied by the strategy’s performance it is implemented live via an API. During this live testing phase the strategy is monitored evaluated. If the strategy performs poorly it must either be improved or scrapped for a new strategy. If the strategy performs well the user may choose to either improve the strategy or increase the lot size of the strategy. Alternatively, if some form of seasonality is identified with the strategy it can be paused and restarted when suitable market conditions are identified. This cycle will continue until the strategy becomes redundant.</p>
<!-- ![Flow chart of strategy optimization pipelines](images/optimization_pipeline_high_level_overview.svg){#fig:optimizationPipeline} -->
<div id="fig:optimizationPipeline" class="fignos">
<figure>
<img src="mermaid-images\a104ae7dd82cd602e050dbfe951ebd8f4f66c616.svg" alt="" /><figcaption><span>Figure 1:</span> Flow chart of strategy optimization pipeline</figcaption>
</figure>
</div>
<h3 id="optimization-environment">Optimization Environment</h3>
<p>An optimization strategy must closely mimic that of a live trading environment. A live trading environment consists of the interactions between a trading trader and an exchange. We can imagine the following entity relationship between the trader and the exchange,</p>
<div id="fig:exchangeAgentRelationship" class="fignos">
<figure>
<img src="images/exchange_market_relationship.svg" alt="" /><figcaption><span>Figure 2:</span> Entity relationship between a trader and an exchange</figcaption>
</figure>
</div>
<p>A trader or multiple traders will query one or more exchanges. Each exchange will consist of multiple markets consisting of multiple feeds.</p>
<p><strong>Example 1:</strong> The Binance exchange contains the btc/usdt market, which in turn consists of a 1 min, 1hr, 1day etc. time frames. A trader looks at the 1hr for the mid-term trend with moving averages. The 1hr trend is bullish, thus he looks for long trades on the minute time frame.</p>
<p><strong>Example 2:</strong> An arbitrage trader would like to capitalize on the variations in price between eth/btc, eth/usdt, btc/usdt. They find that the btc price when calculated from eth vs btc is lower when compared to that of eth vs usdt. They would the code a bot which can capitalize on these variations.</p>
<h4 id="exchange">Exchange</h4>
<p>The Exchange object acts as an interface between a Trader and the available Market. To simulate live trading we define a timestep <span class="math inline"><em>y</em><sub><em>t</em></sub></span> and incrementally step forward in time updating the Markets contained for all exchanges. Each market within the exchanges are iterable and are aligned to start close to the actual time they were added to the exchange. Stepping forward in time will update the state of the Exchange by iterating over the feeds for each market. Once the state of all Exchanges are updated a trading agent will directly interface with the exchange via a strategy method, figure <a href="#fig:exchangeTraderInteraction">3</a>.</p>
<div id="fig:exchangeTraderInteraction" class="fignos">
<figure>
<img src="images/exchange_trader_interaction.svg" alt="" /><figcaption><span>Figure 3:</span> Exchange-Trader environment interaction</figcaption>
</figure>
</div>
<p>We show the intended design of the Exchange class,</p>
<h4 id="sec:trader">Trader</h4>
<p>TBD</p>
<h4 id="sec:Market">Market</h4>
<p>TBD</p>
